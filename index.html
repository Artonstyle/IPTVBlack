<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Black IPTV – Blue Neon 2026</title>
  <script type="text/javascript" src="$WEBAPIS/webapis/webapis.js"></script>
  <style>
    :root {
      --main-blue: #0045ff;
      --neon-cyan: #00d2ff;
      --bg-fallback: radial-gradient(circle at top right, #001a4d, #00050a);
    }
    body {
      width: 1920px; height: 1080px; margin: 0; padding: 0;
      background: var(--bg-fallback);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: white; font-family: sans-serif; overflow: hidden;
      transition: background-image 0.5s ease-in-out;
    }
    /* ... Dein restliches CSS (Menü, Spalten etc.) wie zuvor ... */
    #setup-view { display:none; padding: 50px; gap: 30px; }
    .column { background: rgba(0,0,0,0.5); border: 2px solid var(--neon-cyan); border-radius: 20px; padding: 20px; flex: 1; }
    .bg-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .bg-btn { padding: 20px; background: rgba(255,255,255,0.1); border: 2px solid transparent; border-radius: 10px; text-align: center; font-size: 20px; }
    .bg-btn.focused { background: var(--main-blue); border-color: white; }
    input.focused { border: 2px solid white; background: rgba(0,69,255,0.4); }
    .btn.focused { background: var(--main-blue); border: 2px solid white; }
  </style>
</head>
<body onload="init()">

<header style="height:150px; display:flex; justify-content:space-between; align-items:center; padding:0 50px;">
  <h1>BLACK<span>IPTV</span></h1>
  <nav id="menu" style="display:flex; gap:20px;">
    <div id="i0" class="item">TV</div>
    <div id="i1" class="item">FILME</div>
    <div id="i2" class="item">SERIEN</div>
    <div id="i3" class="item">EINSTELLUNG</div>
  </nav>
</header>

<main id="setup-view" style="display:none; flex-direction:row;">
  <div class="column">
    <h3>1) HINTERGRUND</h3>
    <div class="bg-grid">
      <div id="bg1" class="bg-btn">Galatasaray</div>
      <div id="bg2" class="bg-btn">Blue Neon</div>
      <div id="bg3" class="bg-btn">Dark Mode</div>
      <div id="bg4" class="bg-btn">Standard</div>
    </div>
    <div id="mac-value">MAC: Lade...</div>
  </div>
  <div class="column">
    <h3>2) PLAYLIST</h3>
    <input id="m3u-url" type="text" style="width:100%; padding:15px;" placeholder="M3U URL">
    <div id="btn-save-m3u" class="btn" style="padding:15px; background:blue; margin-top:10px; text-align:center;">SPEICHERN</div>
  </div>
</main>

<script>
  var area = "menu", menuIdx = 3, setupCol = 0, setupIdx = 0;
  var $ = function(id) { return document.getElementById(id); };

  function changeBG(file) {
    if (!file || file === "none") {
      document.body.style.backgroundImage = "none";
    } else {
      // WICHTIG: Die URL muss genau so aussehen für GitHub Raw Bilder
      var rawUrl = "https://raw.githubusercontent.com/Artonstyle/IPTVBlack/main/hintergrund/" + file;
      document.body.style.backgroundImage = "linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('" + rawUrl + "')";
    }
    localStorage.setItem("user_bg", file);
  }

  function getFocusables() {
    if (setupCol === 0) return [
      { el: $("bg1"), file: "bild1.webp" },
      { el: $("bg2"), file: "bild2.webp" },
      { el: $("bg3"), file: "bild3.webp" },
      { el: $("bg4"), file: "none" }
    ];
    return [{ el: $("m3u-url") }, { el: $("btn-save-m3u") }];
  }

  function updateUI() {
    document.querySelectorAll(".item, .bg-btn, .btn, input").forEach(e => e.classList.remove("focused"));
    if (area === "menu") {
      $("i" + menuIdx).classList.add("focused");
      $("setup-view").style.display = (menuIdx === 3) ? "flex" : "none";
    } else {
      var list = getFocusables();
      if (list[setupIdx]) list[setupIdx].el.classList.add("focused");
    }
  }

  window.addEventListener("keydown", function(e) {
    var k = e.keyCode;
    if (area === "menu") {
      if (k === 39 && menuIdx < 3) menuIdx++;
      if (k === 37 && menuIdx > 0) menuIdx--;
      if (k === 40 && menuIdx === 3) { area = "setup"; setupCol = 0; setupIdx = 0; }
    } else {
      var list = getFocusables();
      if (k === 38) { // Hoch
        if (setupIdx > 0) setupIdx--; else area = "menu";
      }
      if (k === 40 && setupIdx < list.length - 1) setupIdx++; // Runter
      if (k === 39 && setupCol === 0) { setupCol = 1; setupIdx = 0; } // Rechts
      if (k === 37 && setupCol === 1) { setupCol = 0; setupIdx = 0; } // Links
      if (k === 13) { // OK Taste
        var item = list[setupIdx];
        if (item.file) changeBG(item.file);
        if (item.el.id === "btn-save-m3u") alert("Gespeichert!");
      }
    }
    updateUI();
  });

  function init() {
    var saved = localStorage.getItem("user_bg");
    if (saved) changeBG(saved);
    try { $("mac-value").innerText = "MAC: " + webapis.network.getMac(); } catch(e) {}
    updateUI();
  }
</script>
</body>
</html>
