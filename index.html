<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Black IPTV 2026 - Stable Remote</title>
  <script type="text/javascript" src="$WEBAPIS/webapis/webapis.js"></script>
  <style>
    :root { --blue: #0045ff; --cyan: #00d2ff; }
    body {
      width: 1920px; height: 1080px; margin: 0; background: #000;
      color: white; font-family: Arial, sans-serif; overflow: hidden;
      background-size: cover; background-position: center;
    }
    header { height: 150px; display: flex; justify-content: center; gap: 40px; align-items: center; background: rgba(0,0,0,0.8); }
    .item { padding: 15px 30px; font-size: 30px; border-radius: 10px; border: 3px solid transparent; color: #777; font-weight: bold; }
    
    /* Der Fokus-Rahmen aus deinem Script */
    .focused { 
      background: var(--blue) !important; 
      border-color: white !important; 
      color: white !important;
      transform: scale(1.1);
      box-shadow: 0 0 40px var(--blue);
    }

    main { display: flex; padding: 60px; gap: 40px; height: 800px; }
    #tv-view { flex: 1; display: flex; justify-content: center; align-items: center; font-size: 40px; }
    #setup-view { display: none; flex: 1; gap: 30px; }
    
    .column { background: rgba(255,255,255,0.1); border-radius: 25px; flex: 1; padding: 40px; text-align: center; border: 1px solid rgba(0,210,255,0.2); }
    .btn { padding: 25px; margin: 15px 0; background: #222; border-radius: 15px; font-size: 26px; border: 4px solid transparent; font-weight: bold; }
    input { width: 90%; padding: 20px; margin-top: 20px; background: #000; color: #00d2ff; border: 2px solid #00d2ff; font-size: 20px; text-align: center; }
  </style>
</head>

<body onload="init()">

  <header id="nav-bar">
    <div id="i0" class="item">TV</div>
    <div id="i1" class="item">FILME</div>
    <div id="i2" class="item">SERIEN</div>
    <div id="i3" class="item">EINSTELLUNG</div>
  </header>

  <main>
    <div id="tv-view">Willkommen - Bitte Link laden</div>

    <div id="setup-view">
      <div class="column">
        <h2 style="color:var(--cyan)">DESIGN</h2>
        <div id="b1" class="btn">GALATASARAY</div>
        <div id="b2" class="btn">BLUE NEON</div>
        <div id="b3" class="btn">SCHWARZ</div>
      </div>

      <div class="column">
        <h2 style="color:var(--cyan)">HANDY SYNC</h2>
        <div id="b4" class="btn">VOM HANDY LADEN</div>
        <input id="url-box" type="text" value="Kein Link aktiv" readonly>
        <div id="mac-info" style="margin-top:40px; font-size:22px; color:var(--cyan)">MAC: Lade...</div>
      </div>
    </div>
  </main>

<script>
  // ===== CONFIG & STATE =====
  const KEY = { UP: 38, DOWN: 40, LEFT: 37, RIGHT: 39, OK: 13, BACK: 10009 };
  let curZone = "top"; 
  let mIdx = 3; // Start bei Einstellungen
  let sIdx = 1; // Start bei Button 1
  let activeStream = "";

  const $ = (id) => document.getElementById(id);

  // ===== NAVIGATION =====
  function updateFocus() {
    document.querySelectorAll(".item, .btn").forEach(el => el.classList.remove("focused"));
    
    if (curZone === "top") {
      $("i" + mIdx).classList.add("focused");
      $("setup-view").style.display = (mIdx === 3) ? "flex" : "none";
      $("tv-view").style.display = (mIdx === 3) ? "none" : "flex";
    } else {
      $("b" + sIdx).classList.add("focused");
    }
  }

  function move(dir) {
    if (curZone === "top") {
      if (dir === "LEFT" && mIdx > 0) mIdx--;
      if (dir === "RIGHT" && mIdx < 3) mIdx++;
      if (dir === "DOWN" && mIdx === 3) { curZone = "setup"; sIdx = 1; }
    } else {
      if (dir === "UP") {
        if (sIdx > 1 && sIdx != 4) sIdx--; 
        else curZone = "top";
      }
      if (dir === "DOWN" && sIdx < 3) sIdx++;
      if (dir === "RIGHT" && sIdx <= 3) sIdx = 4;
      if (dir === "LEFT" && sIdx == 4) sIdx = 1;
    }
    updateFocus();
  }

  // ===== AKTIONEN =====
  function enter() {
    if (curZone === "setup") {
      if (sIdx === 1) setBG("bild1.webp");
      if (sIdx === 2) setBG("bild2.webp");
      if (sIdx === 3) setBG("none");
      if (sIdx === 4) loadRemote();
    }
  }

  function setBG(img) {
    if (img === "none") {
      document.body.style.backgroundImage = "none";
      localStorage.setItem("user_bg", "none");
    } else {
      const url = "https://raw.githubusercontent.com/Artonstyle/IPTVBlack/main/hintergrund/" + img + "?v=" + Date.now();
      document.body.style.backgroundImage = "linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)), url('" + url + "')";
      localStorage.setItem("user_bg", img);
    }
  }

  function loadRemote() {
    // Holt den Link aus deiner playlist.txt auf GitHub
    fetch("https://raw.githubusercontent.com/Artonstyle/IPTVBlack/main/playlist.txt?v=" + Date.now())
    .then(r => r.text()).then(d => {
      activeStream = d.trim();
      $("url-box").value = activeStream.substring(0, 25) + "...";
      localStorage.setItem("user_m3u", activeStream);
      alert("Erfolg: Link gespeichert!");
    }).catch(e => alert("Fehler beim Laden"));
  }

  // ===== INITIALISIERUNG =====
  function init() {
    // Tizen Tasten-Registrierung
    try {
      ["Left", "Up", "Right", "Down", "Enter", "Back"].forEach(k => tizen.tvinputdevice.registerKey(k));
    } catch (e) {}

    // MAC Adresse laden
    try { $("mac-info").innerText = "MAC: " + webapis.network.getMac(); } catch(e) {}

    // Gespeicherten Hintergrund laden
    const savedBg = localStorage.getItem("user_bg");
    if(savedBg) setBG(savedBg);

    // Event Listener f√ºr Fernbedienung
    window.addEventListener("keydown", function(e) {
      const code = e.keyCode;
      if ([KEY.LEFT, KEY.UP, KEY.RIGHT, KEY.DOWN, KEY.OK].includes(code)) e.preventDefault();

      if (code == KEY.UP) move("UP");
      else if (code == KEY.DOWN) move("DOWN");
      else if (code == KEY.LEFT) move("LEFT");
      else if (code == KEY.RIGHT) move("RIGHT");
      else if (code == KEY.OK) enter();
      else if (code == KEY.BACK) {
         if(curZone === "setup") { curZone = "top"; updateFocus(); }
         else { try { tizen.application.getCurrentApplication().exit(); } catch(e) {} }
      }
      updateFocus();
    });

    updateFocus();
  }
</script>
</body>
</html>
