<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Black IPTV 2026 - Fixed Control</title>
  <script type="text/javascript" src="$WEBAPIS/webapis/webapis.js"></script>
  <style>
    :root { --blue: #0045ff; --cyan: #00d2ff; --bg: radial-gradient(circle at top right, #001a4d, #00050a); }
    * { box-sizing: border-box; outline: none; }
    body {
      width: 1920px; height: 1080px; margin: 0; background: var(--bg);
      background-size: cover; background-position: center;
      color: white; font-family: Arial, sans-serif; overflow: hidden;
    }
    header { height: 160px; display: flex; justify-content: space-between; align-items: center; padding: 0 80px; border-bottom: 2px solid rgba(0,210,255,0.2); }
    #menu { display: flex; gap: 20px; }
    .item { padding: 20px 40px; font-size: 35px; font-weight: bold; color: rgba(255,255,255,.45); border-radius: 15px; }
    .item.focused { color: white; background: var(--blue); box-shadow: 0 0 30px var(--blue); transform: scale(1.05); }

    main { display: flex; height: 920px; padding: 50px; gap: 30px; }
    #tv-content { font-size: 40px; margin: auto; }
    
    #setup-view { display: none; width: 100%; gap: 30px; }
    .column { background: rgba(0,0,0,0.6); border: 2px solid rgba(0,210,255,0.6); border-radius: 30px; flex: 1; padding: 30px; display: flex; flex-direction: column; align-items: center; }
    .btn { width: 90%; padding: 20px; margin: 10px 0; background: rgba(255,255,255,0.08); border: 3px solid transparent; border-radius: 15px; text-align: center; font-size: 24px; color: white; }
    .btn.focused { border-color: white; background: rgba(0,69,255,.6); }
    input { width: 90%; padding: 20px; margin: 10px 0; background: #222; border: 1px solid var(--cyan); color: white; font-size: 20px; border-radius: 10px; text-align: center; }
    .status { color: var(--cyan); margin-top: 10px; min-height: 24px; }
  </style>
</head>

<body onload="init()">
  <header>
    <div style="font-size: 50px; font-weight: bold;">BLACK<span style="color:var(--cyan)">IPTV</span></div>
    <nav id="menu">
      <div id="i0" class="item">TV</div>
      <div id="i1" class="item">FILME</div>
      <div id="i2" class="item">SERIEN</div>
      <div id="i3" class="item">EINSTELLUNG</div>
    </nav>
  </header>

  <main>
    <div id="tv-content">Willkommen</div>

    <div id="setup-view">
      <div class="column">
        <h2 style="color:var(--cyan)">DESIGN</h2>
        <div id="b1" class="btn">Galatasaray</div>
        <div id="b2" class="btn">Blue Neon</div>
        <div id="b3" class="btn">Standard</div>
        <div id="mac" class="status" style="margin-top:20px;">MAC: Lade...</div>
      </div>
      <div class="column">
        <h2 style="color:var(--cyan)">HANDY UPLOAD</h2>
        <div id="b4" class="btn">LINK VOM HANDY LADEN</div>
        <input id="url-display" type="text" placeholder="Kein Link aktiv" readonly>
        <div id="status" class="status"></div>
      </div>
    </div>
  </main>

<script>
  var area = "menu", mIdx = 0, sIdx = 1;

  function $(id){ return document.getElementById(id); }

  function update(){
    // Reset focus
    var all = document.querySelectorAll(".item, .btn");
    for(var i=0; i<all.length; i++) all[i].classList.remove("focused");

    // Ansichten umschalten
    $("setup-view").style.display = (mIdx === 3) ? "flex" : "none";
    $("tv-content").style.display = (mIdx === 3) ? "none" : "block";

    if(area === "menu"){
      var mi = $("i"+mIdx);
      if(mi) mi.classList.add("focused");
    } else {
      var si = $("b"+sIdx);
      if(si) si.classList.add("focused");
    }
  }

  function setBG(img){
    if(img==="none"){
      document.body.style.backgroundImage = "";
      return;
    }
    var url = "https://raw.githubusercontent.com/Artonstyle/IPTVBlack/main/hintergrund/" + img + "?t=" + Date.now();
    document.body.style.backgroundImage = "linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('" + url + "')";
  }

  function loadHandy(){
    $("status").innerText = "Lade...";
    var url = "https://raw.githubusercontent.com/Artonstyle/IPTVBlack/main/playlist.txt?t=" + Date.now();
    var xhr = new XMLHttpRequest();
    xhr.open("GET", url, true);
    xhr.onreadystatechange = function(){
      if(xhr.readyState === 4 && xhr.status === 200){
        $("url-display").value = xhr.responseText.trim();
        $("status").innerText = "Geladen âœ“";
      }
    };
    xhr.send();
  }

  function init(){
    // Keys registrieren wie in deinem funktionierenden Code
    try {
      var keys = ["Up","Down","Left","Right","Enter","Back"];
      for(var i=0; i<keys.length; i++){ tizen.tvinputdevice.registerKey(keys[i]); }
    } catch(e){}
    
    // MAC Abruf
    try {
      webapis.network.getMac(function(m){ $("mac").innerText = "MAC: " + m; });
    } catch(e){ $("mac").innerText = "MAC: 00:11:22:33:44"; }

    update();
  }

  // DEIN ORIGINALER KEY-LISTENER
  document.addEventListener("keydown", function(e){
    var k = e.keyCode;

    if(k === 10009 || k === 27){ // Back
      if(area !== "menu"){ area = "menu"; update(); return; }
      try { tizen.application.getCurrentApplication().exit(); } catch(ex){}
      return;
    }

    if(area === "menu"){
      if(k === 37) mIdx = (mIdx > 0) ? mIdx - 1 : 3;
      else if(k === 39) mIdx = (mIdx < 3) ? mIdx + 1 : 0;
      else if(k === 40 && mIdx === 3) { area = "setup"; sIdx = 1; }
      else if(k === 13 && mIdx === 3) { area = "setup"; sIdx = 1; }
    } 
    else if(area === "setup"){
      if(k === 38){ // Up
        if(sIdx > 1) sIdx--;
        else area = "menu";
      }
      else if(k === 40){ // Down
        if(sIdx < 4) sIdx++;
      }
      else if(k === 37 || k === 39){ // Spalte wechseln
        sIdx = (sIdx <= 3) ? 4 : 1;
      }
      else if(k === 13){ // OK
        if(sIdx === 1) setBG("bild1.webp");
        if(sIdx === 2) setBG("bild2.webp");
        if(sIdx === 3) setBG("none");
        if(sIdx === 4) loadHandy();
      }
    }
    update();
  });
</script>
</body>
</html>
