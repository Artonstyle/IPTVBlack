<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1920, height=1080, initial-scale=1.0" />
  <title>BLACK IPTV 2026 – ULTRA HD</title>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script type="text/javascript" src="$WEBAPIS/webapis/webapis.js"></script>

  <style>
    :root {
      --blue: #0045ff;
      --cyan: #00d2ff;
      --bg-dark: #00050a;
      --glass: rgba(0, 40, 120, 0.25);
      --highlight: rgba(0, 210, 255, 0.4);
      --text-muted: rgba(255, 255, 255, 0.6);
    }

    * { box-sizing: border-box; outline: none; user-select: none; }
    
    body {
      width: 1920px; height: 1080px; margin: 0;
      background: radial-gradient(circle at top right, #001a4d, var(--bg-dark));
      color: #fff; font-family: 'Segoe UI', Roboto, Arial, sans-serif;
      overflow: hidden;
    }

    /* Header & Navigation */
    header {
      height: 140px; display: flex; justify-content: space-between;
      align-items: center; padding: 0 80px;
      border-bottom: 1px solid rgba(0, 210, 255, 0.2);
    }
    .brand { font-size: 48px; font-weight: 900; }
    .brand span { color: var(--cyan); }

    nav { display: flex; gap: 20px; }
    .nav-item {
      padding: 15px 40px; font-size: 28px; font-weight: bold;
      color: var(--text-muted); border-radius: 12px; transition: 0.2s;
    }
    .nav-item.focused {
      background: var(--blue); color: #fff;
      box-shadow: 0 0 25px rgba(0, 69, 255, 0.5); transform: scale(1.05);
    }

    /* Main Content */
    main { height: 940px; padding: 30px 60px; }
    .content-area {
      display: none; height: 100%; width: 100%;
      background: var(--glass); border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .content-area.active { display: flex; }

    /* TV Layout */
    .tv-grid { display: flex; width: 100%; height: 100%; padding: 20px; gap: 20px; }
    .tv-list { width: 450px; background: rgba(0,0,0,0.3); border-radius: 15px; overflow-y: auto; }
    .tv-player-side { flex: 1; display: flex; flex-direction: column; gap: 20px; }
    
    .video-container {
      width: 100%; aspect-ratio: 16/9; background: #000;
      border-radius: 15px; overflow: hidden; position: relative;
      border: 2px solid var(--highlight);
    }
    video, object { width: 100%; height: 100%; }

    .list-item {
      padding: 20px; font-size: 24px; border-bottom: 1px solid rgba(255,255,255,0.05);
      transition: 0.1s;
    }
    .list-item.focused { background: var(--blue); color: #fff; }

    /* Setup & Inputs */
    .setup-container { padding: 50px; width: 100%; }
    .input-field {
      width: 100%; padding: 20px; background: rgba(0,0,0,0.5);
      border: 1px solid var(--highlight); color: #fff; font-size: 24px;
      margin-bottom: 20px; border-radius: 10px;
    }
    .input-field.focused { border-color: var(--cyan); box-shadow: 0 0 15px var(--cyan); }

    /* Fullscreen Mode */
    body.fullscreen header { display: none; }
    body.fullscreen main { padding: 0; height: 1080px; }
    body.fullscreen .video-container {
      position: fixed; top: 0; left: 0; width: 1920px; height: 1080px;
      z-index: 1000; border: none; border-radius: 0;
    }
  </style>
</head>

<body onload="startApp()">

  <header id="main-header">
    <div class="brand">BLACK<span>IPTV 2026</span></div>
    <nav id="main-nav">
      <div id="nav-0" class="nav-item" data-target="tv">TV LIVE</div>
      <div id="nav-1" class="nav-item" data-target="vod">VOD</div>
      <div id="nav-2" class="nav-item" data-target="setup">SETUP</div>
    </nav>
  </header>

  <main>
    <div id="view-tv" class="content-area active">
      <div class="tv-grid">
        <div class="tv-list" id="channel-list">
          <div class="list-item">Lade Playlist...</div>
        </div>
        <div class="tv-player-side">
          <div class="video-container" id="player-container">
            <object id="tizen-player" type="application/avplayer"></object>
            <video id="html5-player" autoplay playsinline></video>
          </div>
          <div id="channel-info" style="padding:10px; font-size:32px; font-weight:bold;">Kein Sender gewählt</div>
        </div>
      </div>
    </div>

    <div id="view-setup" class="content-area">
      <div class="setup-container">
        <h1>Profileinstellungen 2026</h1>
        <div class="input-field" id="m3u-url" data-type="input">M3U URL eingeben...</div>
        <div class="nav-item" id="save-btn" style="display:inline-block">SPEICHERN</div>
      </div>
    </div>
  </main>

<script>
  // App Status
  let currentArea = "menu";
  let menuIdx = 0;
  let channelIdx = 0;
  let isTizen = false;
  let hls = null;

  const views = ["view-tv", "view-vod", "view-setup"];

  function startApp() {
    checkPlatform();
    registerKeys();
    updateUI();
  }

  function checkPlatform() {
    if (window.webapis && webapis.avplay) {
      isTizen = true;
      document.getElementById("html5-player").style.display = "none";
    } else {
      isTizen = false;
      document.getElementById("tizen-player").style.display = "none";
    }
  }

  function registerKeys() {
    try {
      const keys = ["Up", "Down", "Left", "Right", "Enter", "Back"];
      keys.forEach(k => tizen.tvinputdevice.registerKey(k));
    } catch (e) { console.log("Standard Browser Mode"); }

    window.addEventListener("keydown", (e) => {
      switch(e.keyCode) {
        case 38: handleMove("up"); break;
        case 40: handleMove("down"); break;
        case 37: handleMove("left"); break;
        case 39: handleMove("right"); break;
        case 13: handleSelect(); break;
        case 10009: // Tizen Back
        case 27:    // ESC
          goBack();
          break;
      }
    });
  }

  function handleMove(dir) {
    if (currentArea === "menu") {
      if (dir === "left" && menuIdx > 0) menuIdx--;
      if (dir === "right" && menuIdx < 2) menuIdx++;
      if (dir === "down") currentArea = "content";
    } else {
      if (dir === "up" && channelIdx === 0) currentArea = "menu";
      if (dir === "up" && channelIdx > 0) channelIdx--;
      if (dir === "down") channelIdx++;
    }
    updateUI();
  }

  function updateUI() {
    // Nav Update
    document.querySelectorAll(".nav-item").forEach((el, i) => {
      el.classList.toggle("focused", currentArea === "menu" && i === menuIdx);
    });

    // View Update
    document.querySelectorAll(".content-area").forEach((v, i) => {
      v.classList.toggle("active", i === menuIdx);
    });
  }

  function playStream(url) {
    console.log("Starte Stream (H.265 fähig):", url);
    
    if (isTizen) {
      try {
        const player = webapis.avplay;
        player.open(url);
        // H.265 wird von Samsung AVPlay automatisch erkannt
        player.prepareAsync(() => {
          player.setDisplayRect(0, 0, 1920, 1080); // Fullscreen Koordinate
          player.play();
        });
      } catch (e) { console.error("Tizen Player Error", e); }
    } else {
      const video = document.getElementById("html5-player");
      if (Hls.isSupported()) {
        if (hls) hls.destroy();
        hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = url;
      }
    }
  }

  function goBack() {
    if (document.body.classList.contains("fullscreen")) {
      document.body.classList.remove("fullscreen");
    } else {
      currentArea = "menu";
      updateUI();
    }
  }

  function handleSelect() {
    if (currentArea === "menu") {
      currentArea = "content";
    } else {
      // Beispiel: Ersten Test-Stream starten
      playStream("https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8");
      document.body.classList.add("fullscreen");
    }
    updateUI();
  }
</script>

</body>
</html>
